# ファイル検索ツール

このツールは指定したディレクトリ内のすべてのファイルから特定のキーワードを検索し、結果をテキストファイルまたはExcelファイルに出力します。

## 機能

- 複数のキーワードを同時に検索
- 検索結果をテキストファイルまたはExcelファイルに出力
- Excelファイルには検索結果のサマリーと詳細情報を含む
- 検索結果の詳細には、ヒットした行の前後2行のコンテキストも表示
- 自動的に日時付きのExcelファイルを生成

## 使い方

### 基本的な使い方

```bash
python search.py キーワード1 キーワード2 ...
```

これにより、現在のディレクトリ内のすべてのファイルから指定したキーワードを検索し、結果を`result_YYYYMMDD_HHMMSS.xlsx`形式のExcelファイルに保存します。

### オプション

- `-d`, `--directory`: 検索対象のディレクトリを指定（デフォルト: カレントディレクトリ）
- `-o`, `--output`: テキスト形式の出力ファイル名を指定
- `-e`, `--excel`: Excel形式の出力ファイル名を指定（指定しない場合は自動生成）

### 使用例

```bash
# 現在のディレクトリで「エラー」と「警告」を検索
python search.py エラー 警告

# 指定したディレクトリで検索
python search.py エラー 警告 -d /path/to/directory

# テキストファイルにも出力
python search.py エラー 警告 -o result.txt

# Excelファイル名を指定
python search.py エラー 警告 -e custom_result.xlsx
```

## Excel出力の特徴

- **検索結果サマリーシート**: 各キーワードのヒット数と該当ファイル数を表示
- **検索結果詳細シート**: 以下の情報を含む詳細な検索結果を表示
  - 検索ワード
  - ファイルパス
  - 行番号
  - ヒットした行の内容
  - 前後2行を含むコンテキスト
- 見やすさを向上させるための色分けと罫線
- ファイルとキーワードごとに背景色を変更
- 折り返し表示によるコンテキストの読みやすさ向上

## 要件

- Python 3.6以上
- openpyxl

## インストール

```bash
pip install openpyxl
``` 